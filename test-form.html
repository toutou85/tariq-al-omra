<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ุฅุฏุฑุงุฌ ุนุฑุถ ุนูุฑุฉ</title>

<style>
*{box-sizing:border-box}
body{margin:0;font-family:Tajawal,Arial;background:#f5f5f5}
.container{max-width:800px;background:#fff;margin:70px auto 20px;padding:20px;border-radius:10px}
h2,h3{text-align:center;color:#8b0000}
label{display:block;margin-top:12px;font-weight:bold}
input,select{width:100%;padding:10px;margin-top:5px;border:1px solid #ccc;border-radius:6px}
.row{display:flex;gap:10px}
.row>div{flex:1}
button{width:100%;margin-top:15px;padding:14px;border:none;border-radius:8px;font-size:16px;cursor:pointer}
.submit{background:#8b0000;color:#fff}
hr{margin:20px 0}
small{color:#777}
</style>
</head>

<body>

<div class="container">
<h2>๐ ุฅุฏุฑุงุฌ ุนุฑุถ ุนูุฑุฉ</h2>

<form id="offerForm">

<!-- ููุน ุงูููุงูุฉ -->
<label>ููุน ุงูููุงูุฉ</label>
<select id="agencyMode" required>
  <option value="">ุงุฎุชุฑ</option>
  <option value="new">โ ููุงูุฉ ุฌุฏูุฏุฉ</option>
  <option value="old">๐ ููุงูุฉ ููุฌูุฏุฉ</option>
</select>

<!-- ูุงุฆูุฉ ุงูููุงูุงุช -->
<div id="agencySelectBox" style="display:none">
  <label>ุงุฎุชุฑ ููุงูุชู</label>
  <select id="agencySelect">
    <option value="">-- ุงุฎุชุฑ --</option>
  </select>
</div>

<!-- ุจูุงูุงุช ุงูููุงูุฉ -->
<label>ุงุณู ุงูููุงูุฉ</label>
<input name="agency" id="agency" required>

<div class="row">
  <div>
    <label>ุงูููุงูุฉ</label>
    <input name="state" id="state" required>
  </div>
  <div>
    <label>ุงูุจูุฏูุฉ</label>
    <input name="city" id="city" required>
  </div>
</div>

<label>ุฑูู ุงููุงุชู</label>
<input name="phone" id="phone" required>

<!-- ุงูุดุนุงุฑ (ุงุฎุชูุงุฑู) -->
<label>ุฑุงุจุท ุดุนุงุฑ ุงูููุงูุฉ (ุงุฎุชูุงุฑู)</label>
<input name="logo" id="logo" placeholder="https://example.com/logo.png">
<small>ูููู ุชุฑู ูุฐุง ุงูุญูู ูุงุฑุบูุง</small>

<hr>

<!-- ุจูุงูุงุช ุงูุนุฑุถ -->
<label>ุงุณู ุงูุนุฑุถ</label>
<input name="offer" required>

<div class="row">
  <div>
    <label>ุชุงุฑูุฎ ุงูุฑุญูุฉ</label>
    <input type="date" name="date" required>
  </div>
  <div>
    <label>ุงููุฏุฉ</label>
    <input name="duration" placeholder="ูุซุงู: 15 ููู" required>
  </div>
</div>

<label>ููุน ุงูุฑุญูุฉ</label>
<select name="flightType" required>
  <option value="">ุงุฎุชุฑ</option>
  <option>ูุจุงุดุฑุฉ</option>
  <option>ุบูุฑ ูุจุงุดุฑุฉ</option>
</select>

<label>ูุทุงุฑ ุงูุฅููุงุน</label>
<select name="airport" required>
  <option value="">ุงุฎุชุฑ</option>
  <option>ูุทุงุฑ ููุงุฑู ุจููุฏูู โ ุงูุฌุฒุงุฆุฑ</option>
  <option>ูุทุงุฑ ุฃุญูุฏ ุจู ุจูุฉ โ ููุฑุงู</option>
  <option>ูุทุงุฑ ูุฑููุฉ</option>
</select>

<h3>๐ฐ ุงูุฃุณุนุงุฑ</h3>

<div class="row">
  <div><input name="group" placeholder="ุบุฑูุฉ ุฌูุงุนูุฉ"></div>
  <div><input name="five" placeholder="ุฎูุงุณูุฉ"></div>
</div>

<div class="row">
  <div><input name="four" placeholder="ุฑุจุงุนูุฉ"></div>
  <div><input name="three" placeholder="ุซูุงุซูุฉ"></div>
</div>

<label>ุบุฑูุฉ ุซูุงุฆูุฉ</label>
<input name="two">

<label>ุงุณู ุงูููุฏู</label>
<input name="hotel" required>

<button type="submit" class="submit">๐ ุฅุฑุณุงู ุงูุนุฑุถ</button>
<p id="msg" style="text-align:center;margin-top:10px"></p>

</form>
</div>

<script>
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbxYkiYg21-llVR_GGKGbFttEI229RrTIaLk-RVFs5YJqbqmkvnCo6VgvNFJGVnyifkJeA/exec";

const agencyMode = document.getElementById("agencyMode");
const agencySelectBox = document.getElementById("agencySelectBox");
const agencySelect = document.getElementById("agencySelect");

const agency = document.getElementById("agency");
const state  = document.getElementById("state");
const city   = document.getElementById("city");
const phone  = document.getElementById("phone");
const logo   = document.getElementById("logo");

let agenciesData = {};

// ุชุบููุฑ ููุน ุงูููุงูุฉ
agencyMode.onchange = () => {
  if(agencyMode.value === "old"){
    agencySelectBox.style.display = "block";
    loadAgencies();
  }else{
    agencySelectBox.style.display = "none";
    agency.value = state.value = city.value = phone.value = logo.value = "";
  }
};

// ุฌูุจ ุงูููุงูุงุช
function loadAgencies(){
  fetch(SCRIPT_URL + "?getAgencies=1")
  .then(r=>r.json())
  .then(data=>{
    agenciesData = data;
    agencySelect.innerHTML = '<option value="">-- ุงุฎุชุฑ --</option>';
    for(let name in data){
      agencySelect.innerHTML += `<option value="${name}">${name}</option>`;
    }
  });
}

// ุชุนุจุฆุฉ ุชููุงุฆูุฉ (ูุน ุงูุดุนุงุฑ ุฅู ูุฌุฏ)
agencySelect.onchange = ()=>{
  const a = agenciesData[agencySelect.value];
  if(!a) return;
  agency.value = agencySelect.value;
  state.value  = a.state || "";
  city.value   = a.city || "";
  phone.value  = a.phone || "";
  logo.value   = a.logo || ""; // ุงุฎุชูุงุฑู
};

// ุงูุฅุฑุณุงู (ููุณ ุงูุทุฑููุฉ ุงูุณุงุจูุฉ)
const form = document.getElementById("offerForm");
const msg  = document.getElementById("msg");

form.addEventListener("submit", e=>{
  e.preventDefault();
  msg.innerText="โณ ุฌุงุฑู ุงูุฅุฑุณุงู...";
  fetch(SCRIPT_URL,{method:"POST",body:new FormData(form)})
  .then(()=>{msg.innerText="โ ุชู ุงูุญูุธ ุจูุฌุงุญ";form.reset();})
  .catch(()=>{msg.innerText="โ ุฎุทุฃ ูู ุงูุฅุฑุณุงู";});
});
</script>

</body>
</html>