<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>عرض بيانات المعتمر</title>
<style>
  body { font-family: 'Tahoma', sans-serif; padding: 20px; background: #f0f2f5; }
  input, button { padding: 10px; margin: 5px 0; }
  .card { background: #fff; padding: 15px; margin-top: 20px; border-radius: 10px; box-shadow: 0 2px 6px rgba(0,0,0,0.1); }
  img { max-width: 200px; display: block; margin-top: 5px; }
</style>
</head>
<body>

<h2>ابحث عن بيانات المعتمر</h2>
<input type="text" id="phoneInput" placeholder="أدخل رقم الهاتف">
<button onclick="search()">بحث</button>

<div id="result"></div>

<script>
const webAppUrl = "https://script.google.com/macros/s/AKfycbxq1F9x3qn0eH4w00P3DXz3pGg66nuAnr0rLYe65k0JT2dIf6D3E9i0Jm49IMUBCtktOQ/exec";

function search() {
  const phone = document.getElementById("phoneInput").value.trim();
  if (!phone) { alert("يرجى إدخال رقم الهاتف"); return; }

  fetch(`${webAppUrl}?phone=${phone}`)
    .then(res => res.json())
    .then(data => {
      const container = document.getElementById("result");
      container.innerHTML = "";

      if (data.found) {
        const div = document.createElement("div");
        div.className = "card";
        div.innerHTML = `
          <h3>الاسم: ${data.firstName} ${data.lastName}</h3>
          <p>الهاتف: ${data.phone}</p>
          <p>البريد: ${data.email}</p>
          <p>العرض: ${data.offerNumber} | الوكالة: ${data.agency}</p>
          <p>نوع الغرفة: ${data.roomType} | السعر: ${data.price}</p>
          <p>نوع الحجز: ${data.reservationType} | الولاية: ${data.wilaya} | الفرع: ${data.branch}</p>
          <p>تاريخ انتهاء جواز السفر: ${data.passportExpiry}</p>
          <p>المرافقين: ${data.companions}</p>
          <p>تاريخ الحجز: ${data.date}</p>
          <p>التأشيرة:</p>
          <img src="${data.visaLink}" alt="صورة التأشيرة">
          <p>التذكرة:</p>
          <img src="${data.ticketLink}" alt="صورة التذكرة">
        `;
        container.appendChild(div);
      } else {
        container.textContent = "لم يتم العثور على المعتمر بهذا الرقم.";
      }
    })
    .catch(err => {
      console.error(err);
      alert("حدث خطأ في جلب البيانات");
    });
}
</script>

</body>
</html>