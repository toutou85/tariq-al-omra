<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ÙØ¶Ø§Ø¡ Ø§Ù„Ù…Ø¹ØªÙ…Ø± | Ø·Ø±ÙŠÙ‚ Ø§Ù„Ø¹Ù…Ø±Ø©</title>

<style>
*{box-sizing:border-box}
body{
  font-family:'Tajawal',Tahoma,Arial,sans-serif;
  margin:0;
  background:#f2f4f8;
}

/* ===== TOP BAR ===== */
.topbar{
  background:#FFD700;
  padding:10px 16px;
  display:grid;
  grid-template-columns:40px 1fr 40px;
  align-items:center;
  position:sticky;
  top:0;
  z-index:1000;
}
.menu-btn{
  font-size:28px;
  font-weight:900;
  cursor:pointer;
}
.topbar-center{text-align:center}
.topbar-center img{
  height:40px;
  display:block;
  margin:0 auto;
}
.topbar-center span{
  font-size:14px;
  font-weight:bold;
}

/* ===== SIDEBAR ===== */
.sidebar{
  position:fixed;
  top:0;
  right:-280px;
  width:280px;
  height:100%;
  background:#fff;
  box-shadow:-4px 0 15px rgba(0,0,0,.3);
  transition:.3s;
  z-index:2000;
  padding-top:60px;
}
.sidebar.active{right:0}
.sidebar a{
  display:block;
  padding:14px 22px;
  text-decoration:none;
  color:#333;
  font-weight:bold;
  border-bottom:1px solid #eee;
}
.sidebar a:hover{background:#f5f5f5}
.closebtn{
  position:absolute;
  top:15px;
  left:15px;
  font-size:28px;
  cursor:pointer;
}

/* ===== PAGE ===== */
.page{
  max-width:900px;
  margin:30px auto;
  padding:15px;
}
.card{
  background:#fff;
  padding:26px;
  border-radius:14px;
  box-shadow:0 6px 18px rgba(0,0,0,.15);
}
input,button{
  padding:14px;
  font-size:18px;
  width:100%;
}
button{
  background:#0d6efd;
  color:#fff;
  border:none;
  cursor:pointer;
  margin-top:15px;
}

/* ===== INFO ===== */
.hint{
  margin:10px 0 20px;
  color:#b00020;
  font-size:16px;
  font-weight:bold;
  text-align:center;
}

/* ===== LOADER ===== */
.loader{
  margin-top:20px;
  padding:20px;
  text-align:center;
  font-size:22px;
  font-weight:bold;
  color:#0d6efd;
  background:#f9f9f9;
  border-radius:12px;
}

/* ===== STATUS ===== */
.status-ok{color:green;font-weight:bold}
.status-no{color:#b00020;font-weight:bold}
.download-btn{
  margin-right:10px;
  background:#198754;
  padding:6px 12px;
  border-radius:6px;
  text-decoration:none;
  color:#fff;
  font-size:14px;
}

/* ===== PRINT ===== */
@page{size:A4;margin:20mm}
@media print{body{background:white}}

.print-header{
  display:flex;
  justify-content:space-between;
  align-items:center;
  border-bottom:2px solid #000;
  padding-bottom:10px;
}
.print-header img{height:30px}
.print-title{font-size:26px;font-weight:bold}
.print-table{
  width:100%;
  border-collapse:collapse;
  margin-top:40px;
  font-size:26px;
}
.print-table td{
  border:1px solid #000;
  padding:14px;
}
.label{font-weight:bold;background:#f3f3f3}

/* ===== STICKER ===== */
.sticker{text-align:center;font-weight:bold}
.sticker-header{
  display:flex;
  justify-content:space-between;
  margin-bottom:30px;
}
.sticker-header img{height:30px}
.sticker .name{font-size:60px}
.sticker .agency{font-size:40px;margin:20px 0}
.sticker .phone{font-size:36px}
</style>
</head>

<body>

<!-- TOP BAR -->
<div class="topbar">
  <span class="menu-btn" onclick="openSidebar()">â˜°</span>
  <div class="topbar-center">
    <img src="https://i.ibb.co/HDMQfZKG/1766852333847-removebg-preview.png">
    <span>Ø·Ø±ÙŠÙ‚ Ø§Ù„Ø¹Ù…Ø±Ø©</span>
  </div>
  <div></div>
</div>

<!-- SIDEBAR -->
<div id="sidebar" class="sidebar">
  <span class="closebtn" onclick="closeSidebar()">Ã—</span>
  <a href="#">ğŸ  Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>
  <a href="#">ğŸ Ø¹Ø±ÙˆØ¶ Ø§Ù„Ø¹Ù…Ø±Ø©</a>
  <a href="#">ğŸ§¾ ÙØ¶Ø§Ø¡ Ø§Ù„Ù…Ø¹ØªÙ…Ø±</a>
  <a href="#">ğŸ“¤ ØªØ­Ù…ÙŠÙ„ Ø¬ÙˆØ§Ø² Ø§Ù„Ø³ÙØ±</a>
  <a href="#">ğŸ“ Ø§ØªØµÙ„ Ø¨Ù†Ø§</a>
  <a href="#">â” Ù…Ù† Ù†Ø­Ù†</a>
</div>

<!-- CONTENT -->
<div class="page">
  <div class="card">

    <h3 style="text-align:center;font-size:24px">ğŸ” Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ù…Ø¹ØªÙ…Ø±</h3>
    <div class="hint">Ø§Ø¯Ø®Ù„ Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ Ø¨Ø¯ÙˆÙ† ØµÙØ±</div>

    <input id="phone" type="tel" value="0"
      onfocus="fixZero(this)" oninput="fixZero(this)">

    <button onclick="search()">Ø¨Ø­Ø«</button>

    <div id="loader" class="loader" style="display:none"></div>
    <div id="result"></div>

  </div>
</div>

<script>
const webAppUrl="PUT_YOUR_GOOGLE_SCRIPT_URL_HERE";
const mainLogo="https://i.ibb.co/HDMQfZKG/1766852333847-removebg-preview.png";

function getAgencyLogo(name=""){
  if(name.includes("ØªÙ‚Ø±Øª")) return "https://i.ibb.co/2XWLPsc/1766858356356-removebg-preview.png";
  if(name.includes("Ø§Ù„Ø§Ù†Ø³ÙŠØ©")) return "https://i.ibb.co/Mk97KqGK/FB-IMG-1766861138141-removebg-preview.png";
  if(name.includes("Ø§Ù„Ø³Ù‚ÙŠÙØ©")) return "https://i.ibb.co/mmrx9QG/FB-IMG-1766861105309-removebg-preview.png";
  return "";
}

function openSidebar(){sidebar.classList.add("active")}
function closeSidebar(){sidebar.classList.remove("active")}

function fixZero(i){
  i.value=i.value.replace(/[^0-9]/g,"");
  if(!i.value.startsWith("0")) i.value="0";
}
function preparePhone(p){
  p=p.replace(/\D/g,"");
  if(p.startsWith("0")) p=p.slice(1);
  if(p.startsWith("213")) p=p.slice(3);
  return p;
}

const adhkar=["Ø£Ø³ØªØºÙØ± Ø§Ù„Ù„Ù‡","Ø³Ø¨Ø­Ø§Ù† Ø§Ù„Ù„Ù‡","Ø§Ù„Ø­Ù…Ø¯ Ù„Ù„Ù‡","Ù„Ø§ Ø¥Ù„Ù‡ Ø¥Ù„Ø§ Ø§Ù„Ù„Ù‡","Ø§Ù„Ù„Ù‡Ù… ØµÙ„ Ø¹Ù„Ù‰ Ù…Ø­Ù…Ø¯"];
let t=null;

function search(){
 const phone=preparePhone(document.getElementById("phone").value);
 if(phone.length<9){alert("Ø±Ù‚Ù… ØºÙŠØ± ØµØ­ÙŠØ­");return}

 loader.style.display="block";
 let i=0;
 loader.innerText="â³ "+adhkar[0];
 t=setInterval(()=>loader.innerText="â³ "+adhkar[i++%adhkar.length],1000);

 fetch(webAppUrl+"?phone="+phone)
 .then(r=>r.json())
 .then(d=>{
  clearInterval(t);
  loader.style.display="none";

  if(!d.found){
    result.innerHTML="âŒ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø¹ØªÙ…Ø±";
    return;
  }

  result.innerHTML=`
  <hr>
  <p><strong>Ø§Ù„Ø§Ø³Ù…:</strong> ${d.firstName} ${d.lastName}</p>
  <p><strong>Ø§Ù„Ù‡Ø§ØªÙ:</strong> ${d.phone}</p>
  <p><strong>Ø§Ù„ÙˆÙƒØ§Ù„Ø©:</strong> ${d.agency}</p>

  <p><strong>Ø§Ù„ØªØ£Ø´ÙŠØ±Ø©:</strong>
    ${d.visaImage?`<span class="status-ok">ØªÙ… Ø¥ØµØ¯Ø§Ø±Ù‡Ø§</span>
    <a class="download-btn" href="${d.visaImage}" target="_blank">ØªØ­Ù…ÙŠÙ„</a>`
    :`<span class="status-no">Ù„Ù… ÙŠØªÙ… Ø¥ØµØ¯Ø§Ø±Ù‡Ø§ Ø¨Ø¹Ø¯</span>`}
  </p>

  <p><strong>Ø§Ù„ØªØ°ÙƒØ±Ø©:</strong>
    ${d.ticketImage?`<span class="status-ok">ØªÙ… Ø¥ØµØ¯Ø§Ø±Ù‡Ø§</span>
    <a class="download-btn" href="${d.ticketImage}" target="_blank">ØªØ­Ù…ÙŠÙ„</a>`
    :`<span class="status-no">Ù„Ù… ÙŠØªÙ… Ø¥ØµØ¯Ø§Ø±Ù‡Ø§ Ø¨Ø¹Ø¯</span>`}
  </p>

  <button onclick="printData(d)">ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø© Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø²Ø¨ÙˆÙ†</button>
  <button onclick="printSticker(d)">ğŸ§³ Ù…Ù„ØµÙ‚ Ø§Ù„Ø­Ù‚ÙŠØ¨Ø©</button>
  `;
 });
}

function printData(d){
 openPrint(`
 <div>
  <div class="print-header">
    <img src="${mainLogo}">
    <div class="print-title">Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø²Ø¨ÙˆÙ† â€“ Ø·Ø±ÙŠÙ‚ Ø§Ù„Ø¹Ù…Ø±Ø©</div>
    <img src="${getAgencyLogo(d.agency)}">
  </div>
  <table class="print-table">
    <tr><td class="label">Ø§Ù„Ø§Ø³Ù…</td><td>${d.firstName} ${d.lastName}</td></tr>
    <tr><td class="label">Ø§Ù„Ù‡Ø§ØªÙ</td><td>${d.phone}</td></tr>
    <tr><td class="label">Ø§Ù„ÙˆÙƒØ§Ù„Ø©</td><td>${d.agency}</td></tr>
  </table>
 </div>
 `);
}

function printSticker(d){
 openPrint(`
 <div class="sticker">
  <div class="sticker-header">
    <img src="${mainLogo}">
    <img src="${getAgencyLogo(d.agency)}">
  </div>
  <div class="name">${d.firstName} ${d.lastName}</div>
  <div class="agency">${d.agency}</div>
  <div class="phone">${d.phone}</div>
 </div>
 `);
}

function openPrint(html){
 const w=window.open("");
 w.document.write(`<html><head><meta charset="UTF-8"></head><body>${html}</body></html>`);
 w.document.close(); w.print();
}
</script>

</body>
</html>