<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ÙØ¶Ø§Ø¡ Ø§Ù„Ù…Ø¹ØªÙ…Ø±</title>

<style>
body{
  font-family: Tahoma, Arial;
  background:#f2f4f8;
  padding:20px;
}
input,button{
  padding:10px;
  font-size:16px;
}
.card{
  background:#fff;
  margin-top:20px;
  padding:20px;
  border-radius:10px;
  box-shadow:0 2px 8px rgba(0,0,0,.15);
}
img{
  max-width:260px;
  margin:10px 0;
  border:1px solid #ccc;
}
.btns button{
  margin:5px;
  background:#0d6efd;
  color:#fff;
  border:none;
  border-radius:5px;
  cursor:pointer;
}
</style>
</head>

<body>

<h2>ğŸ” Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ù…Ø¹ØªÙ…Ø±</h2>
<input id="phone" placeholder="Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ">
<button onclick="search()">Ø¨Ø­Ø«</button>

<div id="result"></div>

<script>
const webAppUrl =
"https://script.google.com/macros/s/AKfycbyCK1clmMlObIIwQTVbXzey-YkT3T18v-ARdqOYw-uQvBhPXN5of-7sBSQDwmy6LDP9ZA/exec";

function search(){
  const phone = document.getElementById("phone").value.trim();
  if(!phone){ alert("Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ"); return; }

  fetch(webAppUrl + "?phone=" + phone)
  .then(r=>r.json())
  .then(d=>{
    const box=document.getElementById("result");
    box.innerHTML="";

    if(!d.found){
      box.innerHTML="<p>âŒ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø¹ØªÙ…Ø±</p>";
      return;
    }

    box.innerHTML=`
    <div class="card" id="printArea">
      <h3>${d.firstName} ${d.lastName}</h3>
      <p>ğŸ“ ${d.phone}</p>
      <p>ğŸ“§ ${d.email}</p>
      <p>ğŸ¢ ${d.agency}</p>
      <p>ğŸ›ï¸ ${d.roomType} | ğŸ’° ${d.price}</p>

      <hr>

      <h4>ğŸ›‚ Ø§Ù„ØªØ£Ø´ÙŠØ±Ø©</h4>
      <img src="${d.visaLink}" onerror="this.style.display='none'">

      <h4>ğŸ« Ø§Ù„ØªØ°ÙƒØ±Ø©</h4>
      <img src="${d.ticketLink}" onerror="this.style.display='none'">

      <div class="btns">
        <button onclick="printText()">ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª</button>
        <button onclick="printImages()">ğŸ–¼ï¸ Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„ØµÙˆØ±</button>
      </div>
    </div>`;
  });
}

function printText(){
  const area=document.getElementById("printArea").cloneNode(true);
  area.querySelectorAll("img,.btns").forEach(e=>e.remove());
  openPrint(area.innerHTML);
}

function printImages(){
  const area=document.getElementById("printArea").cloneNode(true);
  area.querySelectorAll("p,h3,h4,.btns").forEach(e=>e.remove());
  openPrint(area.innerHTML);
}

function openPrint(html){
  const w=window.open("","_blank");
  w.document.write("<html><body>"+html+"</body></html>");
  w.document.close();
  w.print();
}
</script>

</body>
</html>