<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ÙØ¶Ø§Ø¡ Ø§Ù„Ù…Ø¹ØªÙ…Ø± | Ø·Ø±ÙŠÙ‚ Ø§Ù„Ø¹Ù…Ø±Ø©</title>

<style>
*{box-sizing:border-box}
body{
  font-family:'Tajawal',Tahoma,Arial,sans-serif;
  margin:0;
  background:#f2f4f8;
}

/* ===== TOP BAR ===== */
.topbar{
  background:#FFD700;
  padding:12px 16px;
  display:flex;
  align-items:center;
  justify-content:space-between;
  position:sticky;
  top:0;
  z-index:100;
}
.topbar h2{margin:0;font-size:18px}
.menu-btn{font-size:26px;cursor:pointer;font-weight:900}

/* ===== SIDEBAR ===== */
.sidebar{
  height:100%;
  width:0;
  position:fixed;
  top:0;
  right:0;
  background:#fff;
  overflow-x:hidden;
  transition:.3s;
  box-shadow:-4px 0 15px rgba(0,0,0,.3);
  padding-top:60px;
  z-index:999;
}
.sidebar a{
  padding:12px 20px;
  display:block;
  text-decoration:none;
  color:#333;
  font-weight:700;
}
.sidebar a:hover{background:#f2f2f2}
.closebtn{
  position:absolute;
  top:10px;
  left:15px;
  font-size:28px;
  cursor:pointer;
}

/* ===== PAGE ===== */
.page{
  max-width:800px;
  margin:30px auto;
  padding:15px;
}
.card{
  background:#fff;
  padding:20px;
  border-radius:12px;
  box-shadow:0 5px 15px rgba(0,0,0,.15);
}
input,button{
  padding:12px;
  font-size:16px;
}
button{
  background:#0d6efd;
  color:#fff;
  border:none;
  cursor:pointer;
}
.btns button{margin:6px}

/* ===== PRINT A4 ===== */
@page{size:A4;margin:20mm}
@media print{body{background:white}}

.print-a4{
  width:170mm;
}
.print-header{
  display:flex;
  justify-content:space-between;
  align-items:center;
  border-bottom:2px solid #000;
  padding-bottom:10px;
}
.print-header img{height:60px}
.print-title{font-size:20px;font-weight:bold}

.table{
  width:100%;
  border-collapse:collapse;
  margin-top:25px;
}
.table td{
  border:1px solid #000;
  padding:8px;
}
.table .label{
  width:35%;
  font-weight:bold;
  background:#f1f1f1;
}

/* ===== STICKER ===== */
.sticker{
  width:100%;
  height:100%;
  display:flex;
  flex-direction:column;
  justify-content:center;
  align-items:center;
  text-align:center;
  font-weight:bold;
}
.sticker .name{font-size:56px}
.sticker .agency{font-size:36px;margin:15px 0}
.sticker .phone{font-size:30px}
</style>
</head>

<body>

<!-- TOP BAR -->
<div class="topbar">
  <span class="menu-btn" onclick="openSidebar()">â˜°</span>
  <h2>ğŸ•‹ Ø·Ø±ÙŠÙ‚ Ø§Ù„Ø¹Ù…Ø±Ø©</h2>
</div>

<!-- SIDEBAR -->
<div id="mySidebar" class="sidebar">
  <span class="closebtn" onclick="closeSidebar()">Ã—</span>
  <a href="index.html">ğŸ  Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>
  <a href="offers.html">ğŸ Ø¹Ø±ÙˆØ¶ Ø§Ù„Ø¹Ù…Ø±Ø©</a>
  <a href="space.html">ğŸ§¾ ÙØ¶Ø§Ø¡ Ø§Ù„Ù…Ø¹ØªÙ…Ø±</a>
  <a href="upload.html">ğŸ“¤ ØªØ­Ù…ÙŠÙ„ Ø¬ÙˆØ§Ø² Ø§Ù„Ø³ÙØ±</a>
  <a href="contact.html">ğŸ“ Ø§ØªØµÙ„ Ø¨Ù†Ø§</a>
</div>

<!-- PAGE -->
<div class="page">

  <div class="card">
    <h3>ğŸ” Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ù…Ø¹ØªÙ…Ø±</h3>
    <input id="phone" placeholder="Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ">
    <button onclick="search()">Ø¨Ø­Ø«</button>
    <div id="result"></div>
  </div>

</div>

<script>
/* Ø±Ø§Ø¨Ø· Google Apps Script */
const webAppUrl="https://script.google.com/macros/s/AKfycbxNQlPGbAZyLypzmxm9qqt5WJCA8uRCyTmtZBY8JIo01LLzB_HY1X4Odg2Cv_xcTKHmxQ/exec";

/* Ø´Ø¹Ø§Ø±Ø§Øª */
const logoAgency="https://i.ibb.co/d8K117p/1766852254653.jpg";
const logoPath="https://i.ibb.co/bgc4Y7gr/1766852333847.png";

let data=null;

/* Sidebar */
function openSidebar(){document.getElementById("mySidebar").style.width="260px";}
function closeSidebar(){document.getElementById("mySidebar").style.width="0";}

/* Search */
function search(){
 const phone=document.getElementById("phone").value.trim();
 if(!phone) return alert("Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ");

 fetch(webAppUrl+"?phone="+encodeURIComponent(phone))
 .then(r=>r.json())
 .then(d=>{
   if(!d.found){
     result.innerHTML="âŒ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø¹ØªÙ…Ø±";
     return;
   }
   data=d;
   result.innerHTML=`
   <hr>
   <p><strong>Ø§Ù„Ø§Ø³Ù…:</strong> ${d.firstName} ${d.lastName}</p>
   <p><strong>Ø§Ù„Ù‡Ø§ØªÙ:</strong> ${d.phone}</p>
   <p><strong>Ø§Ù„ÙˆÙƒØ§Ù„Ø©:</strong> ${d.agency}</p>
   <p><strong>Ø§Ù„ØºØ±ÙØ©:</strong> ${d.roomType}</p>
   <p><strong>Ø§Ù„Ø³Ø¹Ø±:</strong> ${d.price||"-"}</p>
   <p><strong>Ø§Ù„ØªØ£Ø´ÙŠØ±Ø©:</strong> ${d.visaImage?"ØªÙ… Ø¥ØµØ¯Ø§Ø±Ù‡Ø§":"Ù„Ù… ÙŠØªÙ… Ø¥ØµØ¯Ø§Ø±Ù‡Ø§ Ø¨Ø¹Ø¯"}</p>
   <p><strong>Ø§Ù„ØªØ°ÙƒØ±Ø©:</strong> ${d.ticketImage?"ØªÙ… Ø¥ØµØ¯Ø§Ø±Ù‡Ø§":"Ù„Ù… ÙŠØªÙ… Ø¥ØµØ¯Ø§Ø±Ù‡Ø§ Ø¨Ø¹Ø¯"}</p>

   <div class="btns">
     <button onclick="printData()">ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</button>
     <button onclick="printSticker()">ğŸ§³ Ù…Ù„ØµÙ‚ Ø§Ù„Ø­Ù‚ÙŠØ¨Ø©</button>
   </div>
   `;
 });
}

/* Print Data */
function printData(){
 const d=data;
 openPrint(`
 <div class="print-a4">
  <div class="print-header">
    <img src="${logoAgency}">
    <div class="print-title">Ø§Ø³ØªÙ…Ø§Ø±Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø¹ØªÙ…Ø±</div>
    <img src="${logoPath}">
  </div>

  <table class="table">
    <tr><td class="label">Ø§Ù„Ø§Ø³Ù…</td><td>${d.firstName} ${d.lastName}</td></tr>
    <tr><td class="label">Ø§Ù„Ù‡Ø§ØªÙ</td><td>${d.phone}</td></tr>
    <tr><td class="label">Ø§Ù„ÙˆÙƒØ§Ù„Ø©</td><td>${d.agency}</td></tr>
    <tr><td class="label">Ø§Ù„ØºØ±ÙØ©</td><td>${d.roomType}</td></tr>
    <tr><td class="label">Ø§Ù„Ø³Ø¹Ø±</td><td>${d.price||"-"}</td></tr>
    <tr><td class="label">Ø§Ù„ØªØ£Ø´ÙŠØ±Ø©</td><td>${d.visaImage?"ØªÙ… Ø¥ØµØ¯Ø§Ø±Ù‡Ø§":"Ù„Ù… ÙŠØªÙ… Ø¥ØµØ¯Ø§Ø±Ù‡Ø§ Ø¨Ø¹Ø¯"}</td></tr>
    <tr><td class="label">Ø§Ù„ØªØ°ÙƒØ±Ø©</td><td>${d.ticketImage?"ØªÙ… Ø¥ØµØ¯Ø§Ø±Ù‡Ø§":"Ù„Ù… ÙŠØªÙ… Ø¥ØµØ¯Ø§Ø±Ù‡Ø§ Ø¨Ø¹Ø¯"}</td></tr>
  </table>
 </div>
 `);
}

/* Print Sticker */
function printSticker(){
 const d=data;
 openPrint(`
 <div class="sticker">
   <div class="name">${d.firstName} ${d.lastName}</div>
   <div class="agency">${d.agency}</div>
   <div class="phone">${d.phone}</div>
 </div>
 `);
}

function openPrint(html){
 const w=window.open("");
 w.document.write(`<html><head><meta charset="UTF-8"></head><body>${html}</body></html>`);
 w.document.close();
 w.print();
}
</script>

</body>
</html>