<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ø¹Ø±ÙˆØ¶ Ø§Ù„Ø¹Ù…Ø±Ø©</title>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

<style>
body{font-family:Tajawal,Arial;background:#f5f5f5;margin:0}
.container{max-width:600px;background:#fff;margin:20px auto;padding:20px;border-radius:12px}
.offer-card{background:#fafafa;margin-top:15px;padding:15px;border-radius:10px;border:1px solid #eee}
button,input{width:100%;padding:10px;margin-top:8px;border-radius:8px;border:1px solid #ccc}
button{background:#8b0000;color:#fff;cursor:pointer}
#modal{display:none;position:fixed;inset:0;background:rgba(0,0,0,.6);z-index:9999}
#modalBox{background:#fff;max-width:420px;margin:10% auto;padding:20px;border-radius:12px}
.whatsapp-top{
  position:fixed;top:15px;left:15px;
  width:55px;height:55px;
  background:#25D366;color:#fff;
  border-radius:50%;
  display:flex;align-items:center;justify-content:center;
  font-size:30px;z-index:10000;
}
</style>
</head>

<body>

<a href="https://wa.me/213674141379" target="_blank" class="whatsapp-top">
  <i class="fab fa-whatsapp"></i>
</a>

<div class="container">
<h2>ğŸ•‹ Ø¹Ø±ÙˆØ¶ Ø§Ù„Ø¹Ù…Ø±Ø©</h2>
<div id="offers">â³ Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</div>
</div>

<div id="modal">
  <div id="modalBox">
    <h3 id="m_offer"></h3>
    <p id="m_agency"></p>
    <p id="m_date"></p>
    <p id="m_airport"></p>
    <input id="c_name" placeholder="Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„">
    <input id="c_phone" placeholder="Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ">
    <button id="sendBtn">Ø³Ø¬Ù„ Ø§Ù„Ø¢Ù†</button>
    <button onclick="closeModal()" style="background:#777">Ø¥ØºÙ„Ø§Ù‚</button>
  </div>
</div>

<script>
const OFFERS_API = "https://script.google.com/macros/s/AKfycbx-Q6L4AHvlTXoSuU61aX_ndXT-WdLvWQ9TlCSRF-0P2DiBI5GlnX8UOcGOVFxSyn_lOQ/exec";
let offersData = [];
let selectedOffer = null;

function formatDate(d){
  return new Date(d).toLocaleDateString("ar-DZ",{day:"2-digit",month:"long",year:"numeric"});
}

fetch(OFFERS_API)
.then(r=>r.json())
.then(data=>{
  offersData = data;
  const box=document.getElementById("offers");
  box.innerHTML="";
  data.forEach((o,i)=>{
    const card=document.createElement("div");
    card.className="offer-card";
    card.innerHTML=`
      <h3>${o.offer}</h3>
      <p>${o.agency}</p>
      <p>${formatDate(o.date)}</p>
      <button>ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø¹Ø±Ø¶</button>
    `;
    card.querySelector("button").addEventListener("click",()=>{
      openModal(i);
    });
    box.appendChild(card);
  });
});

function openModal(i){
  selectedOffer = offersData[i];
  m_offer.innerText = selectedOffer.offer;
  m_agency.innerText = selectedOffer.agency;
  m_date.innerText = formatDate(selectedOffer.date);
  m_airport.innerText = selectedOffer.airport;
  modal.style.display="block";
}

function closeModal(){
  modal.style.display="none";
}

document.getElementById("sendBtn").onclick=()=>{
  if(!c_name.value||!c_phone.value){
    alert("Ø£Ø¯Ø®Ù„ Ø§Ù„Ø§Ø³Ù… ÙˆØ±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ");
    return;
  }
  alert("âœ… ØªÙ… Ø§Ù„ØªØ³Ø¬ÙŠÙ„ (Ø§Ø®ØªØ¨Ø§Ø±)");
  closeModal();
};
</script>

</body>
</html>