<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ù…ØªØ§Ø¨Ø¹Ø© Ø·Ù„Ø¨ Ø§Ù„Ø¹Ù…Ø±Ø©</title>

<style>
body{
  font-family:Tajawal,Arial;
  background:#f5f5f5;
  margin:0;
}

/* Ø²Ø± 3 Ø®Ø·ÙˆØ· */
#menuBtn{
  width:30px;
  margin:15px;
  cursor:pointer;
}
#menuBtn span{
  display:block;
  height:3px;
  background:#000;
  margin:6px 0;
  border-radius:2px;
}

/* Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ© */
#sideMenu{
  position:fixed;
  top:0;
  right:-260px;
  width:260px;
  height:100%;
  background:#8b0000;
  padding-top:60px;
  transition:0.3s;
  z-index:1000;
}
#sideMenu a{
  display:block;
  padding:15px;
  color:#fff;
  text-decoration:none;
}
#sideMenu a:hover{
  background:rgba(255,255,255,0.2);
}

/* Ø§Ù„Ø®Ù„ÙÙŠØ© */
#overlay{
  display:none;
  position:fixed;
  inset:0;
  background:rgba(0,0,0,0.5);
  z-index:900;
}

/* Ø§Ù„Ù…Ø­ØªÙˆÙ‰ */
.container{
  max-width:600px;
  background:#fff;
  margin:20px auto;
  padding:20px;
  border-radius:12px;
}
h2{text-align:center;color:#8b0000}
label{display:block;margin-top:15px;font-weight:bold}
input,button{
  width:100%;
  padding:10px;
  margin-top:8px;
  border-radius:8px;
  border:1px solid #ccc;
}
button{
  background:#8b0000;
  color:#fff;
  font-size:16px;
  cursor:pointer;
}
.result{
  margin-top:20px;
  padding:15px;
  background:#f9f9f9;
  border-radius:10px;
}
.status{
  font-weight:bold;
  color:#006400;
}
.note{
  margin-top:10px;
  font-size:14px;
  color:#555;
}

/* Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ø¹Ø±ÙˆØ¶ */
.offer-card{
  background:#fafafa;
  margin-top:15px;
  padding:15px;
  border-radius:10px;
  border:1px solid #eee;
}
.offer-card h3{
  margin:0;
  color:#8b0000;
}
.offer-card p{
  margin:6px 0;
  color:#333;
}
.offer-card button{
  margin-top:10px;
}
</style>
</head>

<body>

<!-- Ø²Ø± Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© -->
<div id="menuBtn">
  <span></span>
  <span></span>
  <span></span>
</div>

<div id="overlay" onclick="closeMenu()"></div>

<nav id="sideMenu">
  <a href="offers.html" onclick="closeMenu()">ğŸ•‹ Ø¹Ø±ÙˆØ¶ Ø§Ù„Ø¹Ù…Ø±Ø© Ø§Ù„Ù…ØªÙˆÙØ±Ø©</a>
</nav>

<div class="container">

<h2>ğŸ“‹ Ù…ØªØ§Ø¨Ø¹Ø© Ø·Ù„Ø¨ Ø§Ù„Ø¹Ù…Ø±Ø©</h2>

<p style="text-align:center;color:#555">
Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ù‡Ø§ØªÙÙƒ Ù„Ù„Ø§Ø·Ù„Ø§Ø¹ Ø¹Ù„Ù‰ Ø­Ø§Ù„Ø© Ø·Ù„Ø¨Ùƒ  
<br>â³ Ù‚Ø¯ ØªØ³ØªØºØ±Ù‚ Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø·Ù„Ø¨ Ø¨Ø¹Ø¶ Ø§Ù„ÙˆÙ‚Øª
</p>

<label>Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ</label>
<input type="tel" id="phone" placeholder="0550123456">

<button onclick="search()">ğŸ” Ø¨Ø­Ø«</button>

<div id="output"></div>

<hr style="margin:30px 0">

<h2>ğŸ•‹ Ø¹Ø±ÙˆØ¶ Ø§Ù„Ø¹Ù…Ø±Ø© Ø§Ù„Ù…ØªÙˆÙØ±Ø©</h2>

<div id="offers">â³ Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¹Ø±ÙˆØ¶...</div>

</div>

<script>
// ğŸ”— Ø±Ø§Ø¨Ø· Google Apps Script (Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…Ø¹ØªÙ…Ø±ÙŠÙ†)
const apiURL =
"https://script.google.com/macros/s/AKfycbxMbVj_Fb7Gam2LPFOgAUpmuhy7jV9RKT_wBSVjGJ1LWyHYc_VqBoIkZZYHFEPdUY9CpA/exec";

// ğŸ”— Ø±Ø§Ø¨Ø· Ø¹Ø±ÙˆØ¶ Ø§Ù„ÙˆÙƒØ§Ù„Ø§Øª
const OFFERS_API =
"https://script.google.com/macros/s/AKfycbx-Q6L4AHvlTXoSuU61aX_ndXT-WdLvWQ9TlCSRF-0P2DiBI5GlnX8UOcGOVFxSyn_lOQ/exec";

// ğŸ” ØªÙˆØ­ÙŠØ¯ Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ
function normalizePhone(phone){
  phone = phone.replace(/\D/g,"");
  if(phone.startsWith("213")) phone = phone.substring(3);
  if(phone.startsWith("0")) phone = phone.substring(1);
  return phone;
}

// ğŸ” Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø­Ø§Ù„Ø© Ø§Ù„Ø·Ù„Ø¨ (ÙƒÙ…Ø§ Ù‡Ùˆ)
function search(){
  const phoneInput = document.getElementById("phone").value;
  const phone = normalizePhone(phoneInput);
  const output = document.getElementById("output");

  if(!phone){
    alert("ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ");
    return;
  }

  output.innerHTML = "â³ Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¨Ø­Ø«...";

  fetch(apiURL + "?phone=" + phone)
    .then(res => res.json())
    .then(data => {

      if(!data.found){
        output.innerHTML = `
          <div class="result">
            âŒ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø·Ù„Ø¨ Ø¨Ù‡Ø°Ø§ Ø§Ù„Ø±Ù‚Ù…
          </div>`;
        return;
      }

      output.innerHTML = `
        <div class="result">
          <p>ğŸ‘¤ <strong>Ø§Ù„Ø§Ø³Ù…:</strong> ${data.name}</p>
          <p>ğŸ“Œ <strong>Ø­Ø§Ù„Ø© Ø§Ù„Ø·Ù„Ø¨:</strong>
            <span class="status">${data.status}</span>
          </p>
          <div class="note">
            â³ Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„Ø­Ø§Ù„Ø© "Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©" ÙŠØ±Ø¬Ù‰ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±  
            ÙˆØ³ÙŠØªÙ… Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹ÙƒÙ… Ù‚Ø±ÙŠØ¨Ù‹Ø§ Ø¥Ù† Ø´Ø§Ø¡ Ø§Ù„Ù„Ù‡
          </div>
        </div>
      `;
    })
    .catch(() => {
      output.innerHTML = "âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø®Ø§Ø¯Ù…";
    });
}

// ğŸ•‹ ØªØ­Ù…ÙŠÙ„ Ø¹Ø±ÙˆØ¶ Ø§Ù„ÙˆÙƒØ§Ù„Ø§Øª ÙÙ‚Ø·
function loadOffers(){
  fetch(OFFERS_API)
    .then(res => res.json())
    .then(data => {
      const box = document.getElementById("offers");
      box.innerHTML = "";

      if(!Array.isArray(data) || data.length === 0){
        box.innerHTML = "âŒ Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¹Ø±ÙˆØ¶ Ø­Ø§Ù„ÙŠØ§Ù‹";
        return;
      }

      data.forEach(o => {
        box.innerHTML += `
          <div class="offer-card">
            <h3>${o.offer}</h3>
            <p>ğŸ¢ <strong>Ø§Ù„ÙˆÙƒØ§Ù„Ø©:</strong> ${o.agency}</p>
          <p>ğŸ“… <strong>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø±Ø­Ù„Ø©:</strong> ${formatDate(o.date)}</p>
            <p>ğŸ’° <strong>Ø³Ø¹Ø± Ø§Ù„ØºØ±ÙØ© Ø§Ù„Ø¬Ù…Ø§Ø¹ÙŠØ©:</strong> ${o.group || "-"}</p>
            <button onclick="showOfferDetails(${JSON.stringify(o)})">
              ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø¹Ø±Ø¶
            </button>
          </div>
        `;
      });
    })
    .catch(() => {
      document.getElementById("offers").innerHTML =
        "âŒ Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¹Ø±ÙˆØ¶";
    });
}

// ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø¹Ø±Ø¶ (Ù…Ø¨Ø¯Ø¦ÙŠÙ‹Ø§)
function showOfferDetails(o){
  alert(
    "ğŸ¨ Ø§Ù„ÙÙ†Ø¯Ù‚: " + o.hotel + "\n" +
    "âœˆï¸ Ù†ÙˆØ¹ Ø§Ù„Ø±Ø­Ù„Ø©: " + o.flight + "\n" +
    "ğŸ›« Ù…Ø·Ø§Ø± Ø§Ù„Ø¥Ù‚Ù„Ø§Ø¹: " + o.airport + "\n" +
    "ğŸ’° Ø®Ù…Ø§Ø³ÙŠØ©: " + o.five + "\n" +
    "ğŸ’° Ø±Ø¨Ø§Ø¹ÙŠØ©: " + o.four + "\n" +
    "ğŸ’° Ø«Ù„Ø§Ø«ÙŠØ©: " + o.three + "\n" +
    "ğŸ’° Ø«Ù†Ø§Ø¦ÙŠØ©: " + o.two
  );
}
<!-- Ù†Ø§ÙØ°Ø© Ù…Ù†Ø¨Ø«Ù‚Ø© -->
<div id="modal" style="display:none;position:fixed;inset:0;background:rgba(0,0,0,.6);z-index:2000">
  <div style="background:#fff;max-width:420px;margin:10% auto;padding:20px;border-radius:12px">
    
    <h3 id="m_offer" style="color:#8b0000"></h3>

    <p id="m_agency"></p>
    <p id="m_date"></p>
    <p id="m_flight"></p>
    <p id="m_airport"></p>
    <p id="m_hotel"></p>

    <p><strong>Ø§Ù„Ø£Ø³Ø¹Ø§Ø±:</strong></p>
    <p id="m_prices"></p>

    <hr>

    <h4>ğŸ“‹ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø²Ø¨ÙˆÙ†</h4>
    <input id="c_name" placeholder="Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„">
    <input id="c_phone" placeholder="Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ">
    <input id="c_email" placeholder="Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ">

    <button onclick="sendOrder()">âœ… Ø³Ø¬Ù„ Ø§Ù„Ø¢Ù†</button>
    <button onclick="closeModal()" style="background:#777;margin-top:5px">Ø¥ØºÙ„Ø§Ù‚</button>

  </div>
</div>

// ğŸ“‚ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ©
const menu = document.getElementById("sideMenu");
const overlay = document.getElementById("overlay");

document.getElementById("menuBtn").onclick = () => {
  menu.style.right = "0";
  overlay.style.display = "block";
};
function formatDate(dateStr){
  const d = new Date(dateStr);
  if (isNaN(d)) return dateStr;

  return d.toLocaleDateString("ar-DZ", {
    day: "2-digit",
    month: "long",
    year: "numeric"
  });
}

function closeMenu(){
  menu.style.right = "-260px";
  overlay.style.display = "none";
}

// ğŸš€ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¹Ø±ÙˆØ¶ Ø¹Ù†Ø¯ ÙØªØ­ Ø§Ù„ØµÙØ­Ø©
loadOffers();
  let selectedOffer = null;

// ÙØªØ­ Ø§Ù„Ù†Ø§ÙØ°Ø©
function showOfferDetails(o){
  selectedOffer = o;

  document.getElementById("m_offer").innerText = o.offer;
  document.getElementById("m_agency").innerText = "ğŸ¢ Ø§Ù„ÙˆÙƒØ§Ù„Ø©: " + o.agency;
  document.getElementById("m_date").innerText = "ğŸ“… ØªØ§Ø±ÙŠØ® Ø§Ù„Ø±Ø­Ù„Ø©: " + formatDate(o.date);
  document.getElementById("m_flight").innerText = "âœˆï¸ Ù†ÙˆØ¹ Ø§Ù„Ø±Ø­Ù„Ø©: " + o.flight;
  document.getElementById("m_airport").innerText = "ğŸ›« Ù…Ø·Ø§Ø± Ø§Ù„Ø¥Ù‚Ù„Ø§Ø¹: " + o.airport;
  document.getElementById("m_hotel").innerText = "ğŸ¨ Ø§Ù„ÙÙ†Ø¯Ù‚: " + o.hotel;

  document.getElementById("m_prices").innerHTML =
    "Ø¬Ù…Ø§Ø¹ÙŠØ©: " + (o.group||"-") + "<br>" +
    "Ø®Ù…Ø§Ø³ÙŠØ©: " + (o.five||"-") + "<br>" +
    "Ø±Ø¨Ø§Ø¹ÙŠØ©: " + (o.four||"-") + "<br>" +
    "Ø«Ù„Ø§Ø«ÙŠØ©: " + (o.three||"-") + "<br>" +
    "Ø«Ù†Ø§Ø¦ÙŠØ©: " + (o.two||"-");

  document.getElementById("modal").style.display = "block";
}

function closeModal(){
  document.getElementById("modal").style.display = "none";
}

// Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨
function sendOrder(){
  const name  = document.getElementById("c_name").value;
  const phone = document.getElementById("c_phone").value;
  const email = document.getElementById("c_email").value;

  if(!name || !phone){
    alert("ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø§Ù„Ø§Ø³Ù… ÙˆØ±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ");
    return;
  }

  fetch("https://script.google.com/macros/s/AKfycbzcxJ2mvd-Nnr5mdzPItK6_3pWnX3kR_EIQuKZanjW93RGIh06d4PDqcdWwMV0AyiVB/exec",{
    method:"POST",
    body: JSON.stringify({
      customer:{
        name, phone, email
      },
      offer:selectedOffer
    })
  })
  .then(r=>r.text())
  .then(()=>{
    alert("âœ… ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨ÙƒØŒ Ø³ÙŠØªÙ… Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹Ùƒ Ù‚Ø±ÙŠØ¨Ù‹Ø§");
    closeModal();
  })
  .catch(()=>{
    alert("âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„");
  });
}

</script>

</body>
</html>
