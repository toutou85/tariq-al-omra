<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø¹Ø±Ø¶ | Ø·Ø±ÙŠÙ‚ Ø§Ù„Ø¹Ù…Ø±Ø©</title>
  <style>
    * { box-sizing: border-box; }
    body {
      font-family: 'Tajawal', sans-serif;
      background: #f4f4f4;
      margin: 0;
      padding: 0;
    }
    nav {
      background: #FFD700;
      padding: 12px;
      text-align: center;
    }
    nav a {
      margin: 0 10px;
      text-decoration: none;
      font-weight: bold;
      color: #000;
    }
    .container {
      max-width: 850px;
      margin: 30px auto;
      background: white;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    .main-img {
      width: 100%;
      border-radius: 12px;
      margin-bottom: 20px;
    }
    h2 {
      color: #d4af37;
      margin-top: 0;
      text-align: center;
    }
    ul {
      list-style: none;
      padding: 0;
      margin: 0;
    }
    ul li {
      padding: 8px 10px;
      border-bottom: 1px solid #eee;
      font-size: 15px;
    }
    .extra-images {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 10px;
      margin-top: 20px;
    }
    .extra-images img {
      width: 100%;
      height: 120px;
      object-fit: cover;
      border-radius: 8px;
    }
    .actions {
      display: flex;
      justify-content: center;
      gap: 15px;
      margin: 20px 0;
    }
    .actions button {
      padding: 10px 20px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-weight: bold;
      font-size: 15px;
      transition: 0.3s;
    }
    .like-btn {
      background: #ff4d4d;
      color: #fff;
    }
    .like-btn:hover { background: #e60000; }
    .share-btn {
      background: #4da6ff;
      color: #fff;
    }
    .share-btn:hover { background: #005ce6; }
    .fixed-btn {
      position: fixed;
      bottom: 15px;
      left: 50%;
      transform: translateX(-50%);
      background: #FFD700;
      color: #000;
      padding: 14px 35px;
      border-radius: 10px;
      font-weight: bold;
      text-decoration: none;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
      z-index: 999;
      transition: 0.3s;
    }
    .fixed-btn:hover {
      background: #fff;
      color: #000;
    }
    .like-count {
      font-size: 14px;
      margin-top: 6px;
      text-align: center;
      color: #444;
    }
  </style>
</head>
<body>

  <nav>
    <a href="index.html">ğŸ  Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>
  </nav>

  <div class="container" id="details-container">
    <p style="text-align:center;">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªÙØ§ØµÙŠÙ„...</p>
  </div>

  <script>
    const params = new URLSearchParams(window.location.search);
    const id = params.get('id');

    // Ø±Ø§Ø¨Ø· Google Apps Script (Ø§Ù‚Ø±Ø£ ÙˆØ¹Ø¯Ù„ Ù…Ù†Ù‡)
    const apiURL = "https://script.google.com/macros/s/AKfycbxQ0REua6idTYcmfcjhD4IcbHM9k25YsTlqnWkVLRjLe0VKI-4BDIAvXzb6EviLJz7E/exec";

    let currentOffer = null;

    fetch(apiURL)
      .then(res => res.json())
      .then(data => {
        currentOffer = data.find(item => item.ID == id);
        const container = document.getElementById("details-container");

        if (!currentOffer) {
          container.innerHTML = "<p style='color:red;'>âŒ Ø§Ù„Ø¹Ø±Ø¶ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯</p>";
          return;
        }

        container.innerHTML = `
          <img class="main-img" src="${currentOffer['Ø±Ø§Ø¨Ø· ØµÙˆØ±Ø© Ø§Ù„ÙÙ†Ø¯Ù‚']}" alt="ØµÙˆØ±Ø© Ø§Ù„ÙÙ†Ø¯Ù‚">
          <h2>${currentOffer['Ø§Ø³Ù… Ø§Ù„Ø¹Ø±Ø¶']}</h2>
          
          <ul>
            <li>ğŸ¢ Ø§Ù„ÙˆÙƒØ§Ù„Ø©: ${currentOffer['Ø§Ù„ÙˆÙƒØ§Ù„Ø©']}</li>
            <li>ğŸ›¬ Ø§Ù„Ù…Ø·Ø§Ø±: ${currentOffer['Ø§Ù„Ù…Ø·Ø§Ø±']}</li>
            <li>ğŸ›« Ù†ÙˆØ¹ Ø§Ù„Ø±Ø­Ù„Ø©: ${currentOffer['Ù†ÙˆØ¹ Ø§Ù„Ø±Ø­Ù„Ø©']}</li>
            <li>âœˆï¸ Ø§Ù„Ø®Ø·ÙˆØ· Ø§Ù„Ø¬ÙˆÙŠØ©: ${currentOffer['Ø§Ù„Ø®Ø·ÙˆØ· Ø§Ù„Ø¬ÙˆÙŠØ©']}</li>
            <li>ğŸ“… ØªØ§Ø±ÙŠØ® Ø§Ù„Ø±Ø­Ù„Ø©: ${currentOffer['ØªØ§Ø±ÙŠØ®  Ø§Ù„Ø± Ø­Ù„Ø©']}</li>
            <li>ğŸ“† Ù…Ø¯Ø© Ø§Ù„Ø±Ø­Ù„Ø©: ${currentOffer['Ù…Ø¯Ø© Ø§Ù„Ø±Ø­Ù„Ø©']}</li>
            <li>ğŸ“¥ Ø§Ù„Ø¯Ø®ÙˆÙ„ ÙˆØ§Ù„Ø®Ø±ÙˆØ¬: ${currentOffer['Ø§Ù„Ø¯Ø®ÙˆÙ„ Ùˆ Ø§Ù„Ø®Ø±ÙˆØ¬']}</li>
            <li>ğŸ¨ Ø§Ù„ÙÙ†Ø¯Ù‚: ${currentOffer['Ø§Ù„ÙÙ†Ø¯Ù‚']} (${currentOffer['Ø¹Ø¯Ø¯ Ø§Ù„Ù†Ø¬ÙˆÙ…']})</li>
            <li>ğŸ“ Ø§Ù„Ù…Ø³Ø§ÙØ© Ø¹Ù† Ø§Ù„Ø­Ø±Ù…: ${currentOffer['Ø§Ù„Ù…Ø³Ø§ÙØ© Ø¹Ù† Ø§Ù„Ø­Ø±Ù…']}</li>
            <li>ğŸ½ï¸ Ø³Ø¹Ø± Ø§Ù„Ø¥Ø·Ø¹Ø§Ù…: ${currentOffer['Ø³Ø¹Ø± Ø§Ù„Ø§Ø·Ø¹Ø§Ù…']}</li>
            <li>ğŸ’° Ø§Ù„ØºØ±ÙØ© Ø§Ù„Ø¬Ù…Ø§Ø¹ÙŠØ©: ${currentOffer['Ø§Ù„Ø³Ø¹Ø± Ø§Ù„ØºØ±ÙØ© Ø§Ù„Ø¬Ù…Ø§Ø¹ÙŠØ© (Ø¯Ø¬)']} Ø¯Ø¬</li>
            <li>ğŸ’° Ø§Ù„Ø®Ù…Ø§Ø³ÙŠØ©: ${currentOffer['Ø§Ù„Ø³Ø¹Ø± Ø§Ù„ØºØ±ÙØ© Ø§Ù„Ø®Ù…Ø§Ø³ÙŠØ© (Ø¯Ø¬)']} Ø¯Ø¬</li>
            <li>ğŸ’° Ø§Ù„Ø±Ø¨Ø§Ø¹ÙŠØ©: ${currentOffer['Ø§Ù„Ø³Ø¹Ø± Ø§Ù„ØºØ±ÙØ© Ø§Ù„Ø±Ø¨Ø§Ø¹ÙŠØ© (Ø¯Ø¬)']} Ø¯Ø¬</li>
            <li>ğŸ’° Ø§Ù„Ø«Ù„Ø§Ø«ÙŠØ©: ${currentOffer['Ø§Ù„Ø³Ø¹Ø± Ø§Ù„ØºØ±ÙØ© Ø§Ù„Ø«Ù„Ø§Ø«ÙŠØ© (Ø¯Ø¬)']} Ø¯Ø¬</li>
            <li>ğŸ’° Ø§Ù„Ø«Ù†Ø§Ø¦ÙŠØ©: ${currentOffer['Ø§Ù„Ø³Ø¹Ø± Ø§Ù„ØºØ±ÙØ© Ø§Ù„Ø«Ù†Ø§Ø¦ÙŠØ© Ø¯Ø¬)']} Ø¯Ø¬</li>
            <li>ğŸ‘¶ Ø£Ù‚Ù„ Ù…Ù† Ø¹Ø§Ù…ÙŠÙ†: ${currentOffer['Ø³Ø¹Ø± Ø§Ù„Ø§Ø·ÙØ§Ù„ Ø§Ù‚Ù„ Ù…Ù† Ø¹Ø§Ù…ÙŠÙ†']} Ø¯Ø¬</li>
            <li>ğŸ§’ Ù…Ù† 2 Ø­ØªÙ‰ 12 Ø³Ù†Ø©: ${currentOffer['Ø³Ø¹Ø± Ø§Ù„Ø§Ø·ÙØ§Ù„ Ø§Ù„Ø§Ù‚Ù„ Ù…Ù† Ø¹Ø§Ù…ÙŠÙ† Ø§Ù„Ù‰ 12 Ø³Ù†Ø©']} Ø¯Ø¬</li>
          </ul>

          <div class="extra-images">
            ${currentOffer['Ø±Ø§Ø¨Ø·ØµÙˆØ±Ø© 2'] ? `<img src="${currentOffer['Ø±Ø§Ø¨Ø·ØµÙˆØ±Ø© 2']}" alt="">` : ""}
            ${currentOffer['Ø±Ø§Ø¨Ø· ØµÙˆØ±Ø© 3'] ? `<img src="${currentOffer['Ø±Ø§Ø¨Ø· ØµÙˆØ±Ø© 3']}" alt="">` : ""}
            ${currentOffer['Ø¨Ø· ØµÙˆØ±Ø© 4'] ? `<img src="${currentOffer['Ø¨Ø· ØµÙˆØ±Ø© 4']}" alt="">` : ""}
            ${currentOffer['Ø±Ø§Ø¨Ø· ØµÙˆØ±Ø© 5'] ? `<img src="${currentOffer['Ø±Ø§Ø¨Ø· ØµÙˆØ±Ø© 5']}" alt="">` : ""}
            ${currentOffer['Ø±Ø§Ø¨Ø· ØµÙˆØ±Ø© 6'] ? `<img src="${currentOffer['Ø±Ø§Ø¨Ø· ØµÙˆØ±Ø© 6']}" alt="">` : ""}
          </div>

          <div class="actions">
            <button class="like-btn" onclick="likeOffer()">ğŸ‘ Ø¥Ø¹Ø¬Ø§Ø¨</button>
            <button class="share-btn" onclick="shareOffer()">ğŸ“¤ Ù…Ø´Ø§Ø±ÙƒØ©</button>
          </div>
          <p class="like-count">Ø§Ù„Ø¥Ø¹Ø¬Ø§Ø¨Ø§Øª: <span id="like-count">${currentOffer['likes'] || 0}</span></p>

          <a class="btn fixed-btn" href="formabc.html?agency=${encodeURIComponent(currentOffer['Ø§Ù„ÙˆÙƒØ§Ù„Ø©'])}&offerID=${encodeURIComponent(currentOffer['ID'])}">Ø§Ø­Ø¬Ø² Ø§Ù„Ø¢Ù†</a>
        `;
      })
      .catch(err => {
        document.getElementById("details-container").innerHTML = "<p style='color:red;'>âŒ ÙØ´Ù„ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªÙØ§ØµÙŠÙ„</p>";
        console.error(err);
      });

    // Ø¯Ø§Ù„Ø© Ø§Ù„Ø¥Ø¹Ø¬Ø§Ø¨ (ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ø¯Ù‘Ø§Ø¯ ÙÙŠ Google Sheets)
    function likeOffer() {
      if (!currentOffer) return;

      fetch(apiURL + "?action=like&id=" + currentOffer.ID)
        .then(res => res.json())
        .then(res => {
          if (res.success) {
            document.getElementById("like-count").innerText = res.likes;
          } else {
            alert("âŒ Ù„Ù… ÙŠØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¥Ø¹Ø¬Ø§Ø¨");
          }
        })
        .catch(err => alert("âš ï¸ Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø¥Ø¹Ø¬Ø§Ø¨"));
    }

    // Ø¯Ø§Ù„Ø© Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ©
    function shareOffer() {
      if (navigator.share) {
        navigator.share({
          title: document.title,
          text: "ğŸŒŸ Ø´Ø§Ù‡Ø¯ Ù‡Ø°Ø§ Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù…ÙŠØ² Ù…Ù† Ø·Ø±ÙŠÙ‚ Ø§Ù„Ø¹Ù…Ø±Ø©:",
          url: window.location.href
        }).catch(err => console.log(err));
      } else {
        alert("ğŸ“Œ Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ© ØºÙŠØ± Ù…Ø¯Ø¹ÙˆÙ…Ø© ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„Ù…ØªØµÙØ­.");
      }
    }
  </script>

</body>
</html>